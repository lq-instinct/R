install.packages("limma")
library(limma)
thyriod=read.table("thyriod.txt",header = TRUE,sep = "\t")
rownames(thyriod)=thyriod[,1]
thyriod=thyriod[,-1]
boxplot(thyriod,col="blue")
thyriod=normalizeBetweenArrays(thyriod)
groupthyriod=read.table("group_thyriod.txt",header = TRUE,row.names = 1,check.names = FALSE)
group=as.character(groupthyriod[,1])
design=model.matrix(~0+factor(group))
colnames(design)=levels(factor(group))
rownames(design)=colnames(thyriod)
fit=lmFit(thyriod,design)
contrast.matrix=makeContrasts(paste0(unique(group),collapse = "-"),levels=design)
fit=lmFit(thyriod,design)
fit2=contrasts.fit(fit,contrast.matrix)
fit2=eBayes(fit2)
tempOutput=topTable(fit2,coef = 1,n=Inf)
l_thyroid=subset(tempOutput,abs(tempOutput$logFC) >2&tempOutput$adj.P.Val<0.05)
